#include<stdio.h> 
#include<iostream>
#include<stdlib.h>
	int size,arrival_time[100],burst_time[100],completion_time[100],waiting_time[100];
	int turnaround_time[100],remaining_bt[100],total_time_quantum=0,read_queue[100];
	double avg_turnaround_time=0,avg_waiting_time=0;
    int current_time,Remaining_proc=size,indicator,time_quantum_i1,time_quantum_i2;
	int time_quantum_itration,remaining_process;
int main() 
{
	using namespace std;
    cout<<"Enter the number of process :";
    cin>>size;
    cout<<"\n\nEnter the arrival time and burst time of the processes\n";
    for(int process_no=0;process_no<size;process_no++)
    {
    	cout<<"\nProcess P"<<process_no+1<<"\n";
		cout<<"\tArrival time = "; 
		cin>>arrival_time[process_no];
		cout<<"\tBurst time = "; 
		cin>>burst_time[process_no]; 
		remaining_bt[process_no]=burst_time[process_no];
		total_time_quantum+=burst_time[process_no];
	}
	system("CLS");
	cout<<"The details of time quantum are as follows:\n";
	cout<<"\nThe time quantum for first Iteration is 3.\n";
	cout<<"The time quantum for second Iteration is 6.\n"; 
	cout<<"After second Iteration the Shortest job will assign CPU.\n\n";
	time_quantum_i1=3;
	time_quantum_i2=6;
	time_quantum_itration=1;
	current_time=0;
	remaining_process=size;
	for(int Process_no=0;Process_no<remaining_process;Process_no++) 
	{	
		if(remaining_bt[Process_no]<time_quantum_i1 && remaining_bt[Process_no]>=0&&current_time<9)
		{ 
			current_time+=remaining_bt[Process_no]; 
			remaining_bt[Process_no]=0;
			indicator = 1;
			time_quantum_itration++;
			remaining_process--;
		} 
		else if(remaining_bt[Process_no]>0&&current_time<9)
		{ 
			if(time_quantum_itration==1)
			{remaining_bt[Process_no]-=time_quantum_i1; 
			time_quantum_itration++;
			current_time+=time_quantum_i1;}
			else if(time_quantum_itration==2)
			{remaining_bt[Process_no]-=time_quantum_i2;
			current_time+=time_quantum_i2;} 
		} 
		else if(remaining_bt[Process_no]<9 && remaining_bt[Process_no]>=3&&current_time<9)
		{ 
			current_time+=remaining_bt[Process_no]; 
			remaining_bt[Process_no]=0;  
			remaining_process--;
			indicator = 1;
		} 
		else if(remaining_bt[Process_no]>3&&current_time<9)
		{ 
			remaining_bt[Process_no]-=time_quantum_i2; 
			current_time+=time_quantum_i2; 
		} 
		if(remaining_bt[Process_no]==0 && indicator==1)			
		{ 
			Remaining_proc--;	
			completion_time[Process_no]=current_time;	
			cout<<completion_time[Process_no];
			turnaround_time[Process_no]=completion_time[Process_no]-arrival_time[Process_no];	
			waiting_time[Process_no]=turnaround_time[Process_no]-burst_time[Process_no];	
			indicator = 0;
                       
		}  
		
	}
	
	for(int Process_no=0;Process_no<remaining_process;Process_no++)
	{
		int min =remaining_bt[0];
		int i = 0,j=0;
	for (i; i < size; i++)
    {
        if (min > remaining_bt[i] && current_time>arrival_time[i])
			{
				min = remaining_bt[i];
			}
  	}
    	
    for (j; j < size; j++)	
    {
    	if(remaining_bt[j]==min)
    	break;
   }
    	if(current_time>arrival_time[j] && min!=100000)
    	{
    		remaining_bt[j]=100000; 
			current_time+=min; 
			completion_time[j]=current_time;
			turnaround_time[j]=completion_time[j]-arrival_time[j];	
			waiting_time[j]=turnaround_time[j]-burst_time[j];	
		}
	}
	
	
	cout<<"\nProcess\tArrival Time\tBurst Time\tCompletion Time\tTurnAround Time\tWaiting Time ";
    for(int i=0;i<size;i++)
    {
        cout<<"\nP"<<i+1<<"\t"<<arrival_time[i]<<"\t\t"<<burst_time[i]<<"\t\t"<<completion_time[i]<<"\t\t"<<turnaround_time[i]<<"\t\t"<<waiting_time[i];
    }
    for(int k=0;k<size;k++)
    {
    	avg_waiting_time+=waiting_time[k];
    	avg_turnaround_time+=turnaround_time[k];
	}
	cout<<"\n\n Average Trunaround time : "<<(avg_turnaround_time)/size<<endl;
	cout<<" Average Waiting time : "<<(avg_waiting_time)/size<<endl;
}
